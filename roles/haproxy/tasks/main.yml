# code: language=ansible
---

- name: Setup HAProxy
  become: true
  vars:
    haproxy_primary_ip: "{{ haproxy.primary_ip | default('192.168.1.1') }}"
    haproxy_virtual_ip: "{{ haproxy.virtual_ip | default('192.168.1.2') }}"
  block:
    - name: Configure Nginx
      ansible.builtin.include_tasks: nginx.yml

    - name: Configure network
      ansible.builtin.include_tasks: network.yml

    - name: Configure firewall
      ansible.builtin.include_tasks: firewall.yml

    - name: Configure port forwarding
      ansible.builtin.include_tasks: port_forwarding.yml

    - name: Configure HAProxy service
      ansible.builtin.include_tasks: service.yml
