---
- name: Copy project files
  hosts: all
  gather_facts: no

  roles:
    - role: copy_project_files

- name: Deploy stacks
  hosts: docker_swarm_manager[0]
  gather_facts: no

  environment: "{{env_vars}}"

  roles:
    - role: docker-networks
      vars:
        networks:
          - ldap
          - reverse_proxy

    - role: docker-stacks
      vars:
        stacks:
          - Traefik
          - Keycloak
          - Booksonic
          - Duplicati
          - Heimdall
          - Jellyfin
          - Nextcloud
          - Pihole
          - Smart Strike
          - Swarmpit
          - TTRSS
