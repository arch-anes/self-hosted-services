---
dependency:
  name: galaxy
  options:
    requirements-file: requirements.yml
driver:
  name: vagrant
  provider:
    name: libvirt
lint: |
  set -e
  yamllint . -s -f colored
  ansible-lint --exclude ${HOME}/.ansible/roles/
platforms:
  - name: replica1
    box: alvistack/ubuntu-24.04
    memory: 2048
    cpus: 2
    groups:
      - k3s_cluster
    interfaces:
      - type: private_network
        libvirt__network_name: molecule_network
        network_name: private_network
        ip: "192.168.123.11"
        auto_config: true
  - name: replica2
    box: alvistack/ubuntu-24.04
    memory: 2048
    cpus: 2
    groups:
      - k3s_cluster
    interfaces:
      - type: private_network
        libvirt__network_name: molecule_network
        network_name: private_network
        ip: "192.168.123.12"
        auto_config: true
  - name: replica3
    box: alvistack/ubuntu-24.04
    memory: 2048
    cpus: 2
    groups:
      - k3s_cluster
    interfaces:
      - type: private_network
        libvirt__network_name: molecule_network
        network_name: private_network
        ip: "192.168.123.13"
        auto_config: true
  - name: replica4
    box: alvistack/ubuntu-24.04
    memory: 2048
    cpus: 2
    groups:
      - k3s_cluster
    interfaces:
      - type: private_network
        libvirt__network_name: molecule_network
        network_name: private_network
        ip: "192.168.123.14"
        auto_config: true
  - name: headscale1
    box: alvistack/ubuntu-24.04
    memory: 1024
    cpus: 1
    groups:
      - headscale
    interfaces:
      - type: private_network
        libvirt__network_name: molecule_network
        network_name: private_network
        ip: "192.168.123.21"
        auto_config: true
provisioner:
  name: ansible
  inventory:
    group_vars:
      all:
        skip_system_setup: false
        skip_firewall_setup: false
        skip_vpn_setup: false
        skip_k8s_setup: false
        skip_binary_update: false
        manifest_only_setup: false
        display_k8s_dashboard_password: false
        chartValuesOverrides:
          disableAllApplications: true
          highAvailability: false 
    host_vars:
      replica1:
        labels:
          - local=true
          - public=true
      replica2:
        k3s_control_node: true
      replica3:
        labels:
          - nas=true
  playbooks:
    converge: converge.yml
    # verify: ../default/verify.yml
# verifier:
#   name: ansible
#   lint:
#     name: ansible-lint
