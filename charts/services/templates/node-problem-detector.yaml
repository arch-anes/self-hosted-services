{{- if and .Values.primaryTenant (not .Values.disableAllApplications) .Values.applications.node_problem_detector.enabled }}
---
apiVersion: helm.cattle.io/v1
kind: HelmChart
metadata:
  name: node-problem-detector
  namespace: kube-system
spec:
  chart: node-problem-detector
  repo: https://charts.deliveryhero.io/
  version: 2.3.14
  targetNamespace: kube-system
  valuesContent: |-
{{- if and (not .Values.disableAllApplications) .Values.applications.prometheus.enabled }}
    metrics:
      enabled: true
      serviceMonitor:
        enabled: true
      prometheusRule:
        enabled: true
{{- end }}
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        memory: 512Mi
{{- end }}
